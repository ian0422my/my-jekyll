---
layout: single
#classes: wide
title:  "Vagrant"
date:   2021-09-06 10:25:50 +0800
categories: vagrant
toc: true
toc_label: "In this page"
toc_icon: " "
toc_sticky: true
sidebar:
  nav: "about"
---

## Purpose

* to create a vm and run it with a settings (predefined set of instructions)
* find the box you need @ <https://app.vagrantup.com/boxes/search> (please set proxy using http_proxy, https_proxy)

```Vagrantfile
# -*- mode: ruby -*-
# vi: set ft=ruby :

# All Vagrant configuration is done below. The "2" in Vagrant.configure
# configures the configuration version (we support older styles for
# backwards compatibility). Please don't change it unless you know what
# you're doing.
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/trusty64"
  config.vm.box_url = "https://app.vagrantup.com/ubuntu/boxes/trusty64"
end
```

## list of exisitng boxes

<https://www.vagrantbox.es68>

## Create your own box

<https://scotch.io/tutorials/how-to-create-a-vagrant-base-box-from-an-existing-one>

## CLI

* extra
  * all cli can be debug with --debug
  * all cli output can be output to file using &> log.log
* vagrant plugin install <plugin name>
  * sometimes you might not be able to install if the certificate is self-signed, run this in cygwin @  How to configure Vagrant to ignore SSL certificate â€“ sleeplessbeastie's notes
    * linux

```sh
echo :ssl_verify_mode: 0 | tee ~/.gemrc 
```

    * window
      * create c:\users\<your nmae>\.gemrc 
			* edit and add content below
			* 
	* vagrant plugin expunge --reinstall
	* vagrant ssh-config
	* vagrant global-status - check vm running



```txt
:ssl_verify_mode: 0
```

## Troubleshooting

### cannot reload vagrant

```cmd
There was an error while executing `VBoxManage`, a CLI used by Vagrant
for controlling VirtualBox. The command and stderr is shown below.

Command: ["startvm", "fc202717-d4f4-4881-82f7-a5391f49f669", "--type", "headless"]

Stderr: VBoxManage.exe: error: The VM session was closed before any attempt to power it on
VBoxManage.exe: error: Details: code E_FAIL (0x80004005), component SessionMachine, interface ISession
```

* open Task Manager and remove all services that starts with "Virtual..."
* run "vagrant reload"
